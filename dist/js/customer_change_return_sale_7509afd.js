var formTip='<div id="formTip" class="formTip"></div>',$itemTips=$(".item-tips"),container=$(".contarin"),orderReviseInfoCon=$("#orderReviseInfoCon"),_vParams=JSON.parse(decodeURI(getQueryString("param"))),_reg=/^(\s|\S)+(jpg|jpeg|png|gif|bmp|JPG|JPEG|PNG|GIF|BMP)+$/,privateDefultUser,$scope={},$platformCurrencyList,$currencySymbol="",$priceDecimalNum="",$amountDecimalNum="",$fileListData1,$logisticsType={},$change={};$scope.sc_files=[];var returnSale=function(){this.init()};returnSale.prototype={init:function(){var o=this;o.changeReason=[],o.load=!1,setTimeout(function(){container.show(),fnTip.hideLoading()},0),requestFn("B03_POCType",function(e){"0"==e.errorCode&&(o.changeTypeList=e.dataSet.data.detail)}),requestFn("B03_POCReasonType",function(e){"0"==e.errorCode&&(o.reasonType=e.dataSet.data.detail,L=o.reasonType.length,o.reasonType.forEach(function(e){o.changeReason.push(e.Value)}))}),requestFn("B02_LogisticsType",function(e){"0"==e.errorCode&&(o.logisticsType=e.dataSet.data.detail,$scope.logisticsType=[],o.logisticsType.forEach(function(o){$scope.logisticsType.push(o.Value)}))}),requestFn("B02_Invoice",function(e){"0"==e.errorCode&&(o.invoiceInfoName=e.dataSet.data.detail)}),requestFn("B02_InvoiceType",function(e){"0"==e.errorCode&&(o.invoiceType=e.dataSet.data.detail)}),GetUserInfo("POST",{token:_vParams.token,secretNumber:_vParams.secretNumber},function(o){"01230"==o.retCode&&(privateDefultUser=o)}),o.start()},start:function(){function o(o,e,n){$(o).select3({allowClear:!0,items:e,placeholder:"请选择",showSearchInputInDropdown:!1,value:n})}function e(){return'<div class="m-item m-item-select">	<h2 class="m-title">变更原因：</h2>	<div id="changeCause" class="select3-input"></div></div><div class="m-item">	<h2 class="m-title">变更说明：</h2>	<div class="item-wrap int-remarks">		<textarea name="" id="intRemarks" placeholder="变更说明"></textarea>	</div></div><div class="btn-wrap">	<a href="javascript:;" id="saveChangeCause" class="btnB">完成</a></div>'}function n(o){var e='<div id="rePayInfoList" class="m-item">	<div class="item-wrap">		<section class="clearfix">			<span class="c-label">物流方式：</span>			<div class="c-cont">				<p class="c-txt">'+enumFn(l.logisticsType,$scope.pocNoticeInfo.logisticsType)+'</p>			</div>		</section>		<section id="address" class="clearfix">			<span class="c-label">'+(3==$logisticsType.logisticsType?"自提点":"收货地址")+'：</span>			<div class="c-cont">				<p class="c-txt">'+$scope.pocNoticeInfo.provinceName+$scope.pocNoticeInfo.cityName+$scope.pocNoticeInfo.districtName+$scope.pocNoticeInfo.address+"<br>收货人："+$scope.pocNoticeInfo.contactPerson+"，电话："+$scope.pocNoticeInfo.mobile+"</p>			</div>		</section>";return e+=1==$scope.pocNoticeInfo.invoice?'		<section class="clearfix">			<span class="c-label">发票信息：</span>			<div class="c-cont">				<p class="c-txt">'+enumFn(l.invoiceInfoName,$scope.pocNoticeInfo.invoice)+"</p>			</div>		</section>":'		<section class="clearfix">			<span class="c-label">发票类型：</span>			<div class="c-cont">				<p class="c-txt">'+enumFn(l.invoiceType,$scope.pocNoticeInfo.invoiceType)+'</p>			</div>		</section>		<section class="clearfix">			<span class="c-label">开票抬头：</span>			<div class="c-cont">				<p class="c-txt">'+$scope.pocNoticeInfo.invoiceHeader+'</p>			</div>		</section>		<section class="clearfix">			<span class="c-label">发票内容：</span>			<div class="c-cont">				<p class="c-txt">'+$scope.pocNoticeInfo.invoiceContent+"</p>			</div>		</section>",e+='</div></div><div class="btn-wrap"><a href="javascript:;" id="savePayInfo" class="btnB" data-scrollTop="'+o+'">返回</a></div>'}function c(o){var e='<div class="remarks-wrap"><div id="provisions" class="item-wrap clause">	<h2>补充条款：</h2>	<p>'+$scope.pocNoticeInfo.agreeMent+'</p></div><div id="taRemarks" class="item-wrap taRemarks">	<h2>客户备注：</h2>	<p>'+$change.changeRemark+'</p></div><div id="files" class="item-wrap attachment">	<h2>客户附件：</h2></div><div class="item-wrap">	<h2>本方备注：</h2>	<p>'+$change.changeRemark+'</p></div><div id="vFiles" class="item-wrap attachment">	<h2>本方附件：</h2></div></div></div><div class="btn-wrap"><a href="javascript:;" id="saveRemark" class="btnB" data-scrollTop="'+o+'">完成</a></div>';return e}function a(){var o={soChangeInfo:{}};return o.soChangeInfo.companyId=$scope.pocNoticeInfo.companyId,o.soChangeInfo.companyCode=$scope.pocNoticeInfo.companyCode,o.soChangeInfo.companyName=$scope.pocNoticeInfo.companyName,o.soChangeInfo.companyAbbr=$scope.pocNoticeInfo.companyAbbr,o.soChangeInfo.vendorId=$scope.pocNoticeInfo.vendorId,o.soChangeInfo.vendorCode=$scope.pocNoticeInfo.vendorCode,o.soChangeInfo.vendorName=$scope.pocNoticeInfo.vendorName,o.soChangeInfo.vendorAbbr=$scope.pocNoticeInfo.vendorAbbr,o.soChangeInfo.soManId=$scope.pocNoticeInfo.poManId,o.soChangeInfo.soManCode=$scope.pocNoticeInfo.poManCode,o.soChangeInfo.soManName=$scope.pocNoticeInfo.poManName,o.soChangeInfo.soManPid=$scope.pocNoticeInfo.poManPid,o.soChangeInfo.socManId=$scope.pocNoticeInfo.pocManId,o.soChangeInfo.socManCode=$scope.pocNoticeInfo.pocManCode,o.soChangeInfo.socManName=$scope.pocNoticeInfo.pocManName,o.soChangeInfo.socManPid=$scope.pocNoticeInfo.pocManPid,o.soChangeInfo.pCurrencyCode=$scope.pocNoticeInfo.pCurrencyCode,o.soChangeInfo.pCurrencyName=$scope.pocNoticeInfo.pCurrencyName,o.soChangeInfo.currencyId=$scope.pocNoticeInfo.currencyId,o.soChangeInfo.currencyCode=$scope.pocNoticeInfo.currencyCode,o.soChangeInfo.currencyName=$scope.pocNoticeInfo.currencyName,o.soChangeInfo.localCurrencyId=$scope.pocNoticeInfo.localCurrencyId,o.soChangeInfo.localCurrencyCode=$scope.pocNoticeInfo.localCurrencyCode,o.soChangeInfo.localCurrencyName=$scope.pocNoticeInfo.localCurrencyName,o.soChangeInfo.exchangeRate=$scope.pocNoticeInfo.exchangeRate,o.soChangeInfo.taxId=$scope.pocNoticeInfo.taxId,o.soChangeInfo.taxCode=$scope.pocNoticeInfo.taxCode,o.soChangeInfo.taxName=$scope.pocNoticeInfo.taxName,o.soChangeInfo.isContainTax=$scope.pocNoticeInfo.isContainTax,o.soChangeInfo.taxRate=$scope.pocNoticeInfo.taxRate,o.soChangeInfo.conditionId=$scope.pocNoticeInfo.conditionId,o.soChangeInfo.conditionCode=$scope.pocNoticeInfo.conditionCode,o.soChangeInfo.conditionName=$scope.pocNoticeInfo.conditionName,o.soChangeInfo.payWayId=$scope.pocNoticeInfo.payWayId,o.soChangeInfo.payWayCode=$scope.pocNoticeInfo.payWayCode,o.soChangeInfo.payWayName=$scope.pocNoticeInfo.payWayName,o.soChangeInfo.payMentType=$scope.pocNoticeInfo.payMentType,o.soChangeInfo.logisticsType=$logisticsType.logisticsType,o.soChangeInfo.logisticsCode=$scope.pocNoticeInfo.logisticsCode,o.soChangeInfo.logisticsName=$scope.pocNoticeInfo.logisticsName,o.soChangeInfo.poTotalAmount=$scope.pocNoticeInfo.poTotalAmount,o.soChangeInfo.poTotal=$scope.pocNoticeInfo.poTotal,o.soChangeInfo.poTaxTotal=$scope.pocNoticeInfo.poTaxTotal,o.soChangeInfo.poOtherCostTotal=$scope.pocNoticeInfo.poOtherCostTotal,o.soChangeInfo.total=$scope.pocNoticeInfo.total,o.soChangeInfo.taxTotal=$scope.pocNoticeInfo.taxTotal,o.soChangeInfo.totalAmount=$scope.pocNoticeInfo.totalAmount,o.soChangeInfo.otherCostTotal=$scope.pocNoticeInfo.otherCostTotal,o.soChangeInfo.addressId=$scope.pocNoticeInfo.addressId,o.soChangeInfo.countryCode=$scope.pocNoticeInfo.countryCode,o.soChangeInfo.countryName=$scope.pocNoticeInfo.countryName,o.soChangeInfo.provinceCode=$scope.pocNoticeInfo.provinceCode,o.soChangeInfo.provinceName=$scope.pocNoticeInfo.provinceName,o.soChangeInfo.cityCode=$scope.pocNoticeInfo.cityCode,o.soChangeInfo.cityName=$scope.pocNoticeInfo.cityName,o.soChangeInfo.districtCode=$scope.pocNoticeInfo.districtCode,o.soChangeInfo.districtName=$scope.pocNoticeInfo.districtName,o.soChangeInfo.address=$scope.pocNoticeInfo.address,o.soChangeInfo.contactPerson=$scope.pocNoticeInfo.contactPerson,o.soChangeInfo.mobile=$scope.pocNoticeInfo.mobile,o.soChangeInfo.insideAddressCode=$scope.pocNoticeInfo.insideAddressCode,o.soChangeInfo.invId=$scope.pocNoticeInfo.invId,o.soChangeInfo.invCode=$scope.pocNoticeInfo.invCode,o.soChangeInfo.invName=$scope.pocNoticeInfo.invName,o.soChangeInfo.invoiceType=$scope.pocNoticeInfo.invoiceType,o.soChangeInfo.invoiceHeader=$scope.pocNoticeInfo.invoiceHeader,o.soChangeInfo.invoicePayMark=$scope.pocNoticeInfo.invoicePayMark,o.soChangeInfo.invoiceContent=$scope.pocNoticeInfo.invoiceContent,o.soChangeInfo.invoice=$scope.pocNoticeInfo.invoice,o.soChangeInfo.invoiceName=$scope.pocNoticeInfo.invoiceName,o.soChangeInfo.invoiceTel=$scope.pocNoticeInfo.invoiceTel,o.soChangeInfo.invoiceAddress=$scope.pocNoticeInfo.invoiceAddress,o.soChangeInfo.invoiceBank=$scope.pocNoticeInfo.invoiceBank,o.soChangeInfo.invoiceAccount=$scope.pocNoticeInfo.invoiceAccount,o.soChangeInfo.soId=$scope.orderInfo.id,o.soChangeInfo.soFormNo=$scope.orderInfo.soFormNo,o.soChangeInfo.soInsideNo=$scope.orderInfo.soInsideNo,o.soChangeInfo.soFormDateStr=$scope.orderInfo.soFormDate,o.soChangeInfo.socInsideNo=$scope.orderInfo.soInsideNo,o.soChangeInfo.socFormDateStr=$scope.pocNoticeInfo.pocFormDate,o.soChangeInfo.pocId=$scope.pocNoticeInfo.id.toString(),o.soChangeInfo.pocFormNo=$scope.pocNoticeInfo.pocFormNo,o.soChangeInfo.pocInsideNo=$scope.pocNoticeInfo.pocInsideNo,o.soChangeInfo.changeReason=$change.changeReason||5,o.soChangeInfo.agreeMent=$scope.pocNoticeInfo.agreeMent,o.soChangeInfo.status=2,o.soChangeInfo.billStatus=1,o.soChangeInfo.cRemark=$scope.pocNoticeInfo.poRemark,o.soChangeInfo.vRemark=$scope.pocNoticeInfo.remark,o.soChangeInfo.remark=$change.changeRemark,o.soChangeInfo.currencySymbol=$scope.pocNoticeInfo.currencySymbol,o.soChangeInfo.priceDecimalNum=$scope.pocNoticeInfo.priceDecimalNum,o.soChangeInfo.amountDecimalNum=$scope.pocNoticeInfo.amountDecimalNum,o.soChangeInfo.changeType=$scope.pocNoticeInfo.changeType,o.soChangeInfo.scLineList=t(),o.soChangeInfo.scFileList=i(),o.soChangeInfo.scOtherCostList=s(),o.secretNumber=_vParams.secretNumber,o.token=_vParams.token,o.serviceId="B03_poChangeToSoChange",o.commonParam=commonParam(),o}function s(){var o=[];return $scope.costList.forEach(function(e,n){o.push({lineNo:n+1,soOtherCostId:e.id,poChangeOtherCostId:e.id,costSource:e.costSource,costName:e.costName,costAmount:e.costAmount,changeCostAmount:e.changeCostAmount,changeType:e.changeType,remark:e.remark})}),o}function i(){var o=[];return $scope.sc_files.forEach(function(e,n){e.isDeleted||o.push({fileName:e.fileName,fileSize:e.fileSize,fileUrl:e.fileUrl,lineNo:n+1,fileSource:2})}),o}function t(){var o=[];return $scope.lineList.forEach(function(e,n){o.push({lineNo:n+1,soId:$scope.pocNoticeInfo.soId,soFormNo:$scope.orderInfo.soFormNo,soLineId:e.soLineId,soLineNo:e.soLineNo,pocId:$scope.pocNoticeInfo.id.toString(),pocFormNo:$scope.pocNoticeInfo.pocFormNo,pocLineId:e.id,pocLineNo:e.lineNo,prodId:3==$scope.pocNoticeInfo.changeType?e.vProdId:e.prodId,prodCode:3==$scope.pocNoticeInfo.changeType?e.vProdCode:e.prodCode,prodName:3==$scope.pocNoticeInfo.changeType?e.vProdName:e.prodName,prodScale:3==$scope.pocNoticeInfo.changeType?e.vProdScale:e.prodScale,prodDesc:e.prodDesc,cProdId:e.cProdId,cProdCode:e.cProdCode,cProdName:e.cProdName,cProdScale:e.cProdScale,cProdDesc:e.cProdDesc,invId:e.invId,invCode:e.invCode,invName:e.invName,locationId:e.locationId,locationCode:e.locationCode,locationName:e.locationName,salesQty:e.purchaseQty,changeQty:e.changeQty,valuationQty:e.valuationQty,changeValuationQty:e.changeValuationQty,salesUnitId:e.valuationUnitId,salesUnitCode:e.valuationUnitCode,salesUnitName:e.valuationUnitName,valuationUnitId:e.valuationUnitId,valuationUnitCode:e.valuationUnitCode,valuationUnitName:e.valuationUnitName,price:e.price,changePrice:e.changePrice,taxPrice:e.taxPrice,changeTaxPrice:e.changeTaxPrice,lineAmount:e.lineAmount,changeLineAmount:e.changeLineAmount,taxLineTotal:e.taxLineTotal,changeTaxLineTotal:e.changeTaxLineTotal,expectedDeliveryStr:e.expectedDelivery,changeExpectedDeliveryStr:e.changeExpectedDelivery,batchDelivery:e.batchDelivery,changeType:e.changeType,fileCount:e.fileCount,status:e.status,remark:e.remark}),o[n].scLineFileList=e.up_file,o[n].fileCount=e.up_file.length}),o}function p(o){o.up_file=[],GetAJAXData("POST",{serviceId:"B01_findFileList",docType:25,companyId:$scope.pocNoticeInfo.vendorId,searchType:2,id:o.id,token:_vParams.token,secretNumber:_vParams.secretNumber,commonParam:commonParam()},function(e){e.success&&e.fileList.forEach(function(e){o.up_file.push({id:e.id,fileName:e.fileName,fileSize:e.fileSize,fileUrl:e.fileUrl,lineNo:e.lineNo})})})}function r(o,e,n,c,a){new Popup({type:o,title:e,content:n,ok:"确定",cancel:"取消",closeCallBack:c,okCallBack:a})}var l=this,m=!0,f={serviceId:"B03_getPocNoticeInfo",token:_vParams.token,secretNumber:_vParams.secretNumber,id:_vParams.id,companyId:_vParams.companyId};if(GetAJAXData("POST",f,function(o){if(o.success){m=!0,$scope.pocNoticeInfo=o.pocNoticeInfo,$currencySymbol=$scope.pocNoticeInfo.currencySymbol,$priceDecimalNum=$scope.pocNoticeInfo.priceDecimalNum,$amountDecimalNum=$scope.pocNoticeInfo.amountDecimalNum;var e="";e+='<h2 class="m-title">变更信息</h2><div class="item-wrap">	<ul>		<li><span>所属公司：</span><p>'+$scope.pocNoticeInfo.vendorName+"</p></li>		<li><span>客户：</span><p>"+$scope.pocNoticeInfo.companyName+"</p></li>		<li><span>销售单号：</span>"+$scope.pocNoticeInfo.soFormNo+"</li>		<li><span>内部销售单号：</span>"+$scope.pocNoticeInfo.soInsideNo+"</li>		<li><span>变更类型：</span>"+enumFn(l.changeTypeList,$scope.pocNoticeInfo.changeType)+"</li>		<li><span>变更日期：</span>"+transDate($scope.pocNoticeInfo.pocFormDate)+"</li>	</ul></div>",$("#orderChangeInfo").html(e),$logisticsType.currValue=enumFn(l.logisticsType,$scope.pocNoticeInfo.logisticsType),$logisticsType.logisticsType=$scope.pocNoticeInfo.logisticsType,$change.changeReason=$scope.pocNoticeInfo.changeReason,$change.changeRemark=$scope.pocNoticeInfo.remark,$change.changeReasonVal=enumFn(l.reasonType,$change.changeReason)}else container.html('<p style="text-align:center;">'+o.errorMsg+"</p>"),m=!1}),m){var d={serviceId:"B03_getSalesOrderInfo",token:_vParams.token,secretNumber:_vParams.secretNumber,id:$scope.pocNoticeInfo.soId,companyId:_vParams.companyId};GetAJAXData("POST",d,function(o){if(o.success){$scope.orderInfo=o.salesOrderInfo;var e="";e+='<h2 class="m-title">基础信息</h2><div class="item-wrap">	<ul>		<li><span>销售日期：</span><p>'+transDate($scope.orderInfo.soFormDate)+"</p></li>		<li><span>交易币别：</span><p>"+$scope.orderInfo.currencyName+"</p></li>		<li><pan>交易税别：</span>"+$scope.orderInfo.taxName+'<label class="checkbox'+(1==$scope.orderInfo.isContainTax?" on":"")+'"><input type="checkbox" checked="checked" disabled>含税'+100*$scope.orderInfo.taxRate+"%</label></li>		<li><span>交易条件：</span>"+$scope.orderInfo.conditionName+"</li>		<li><span>收款条件：</span>"+$scope.orderInfo.payWayName+"</li>		<li><span>业务员：</span>"+$scope.orderInfo.soManName+"</li>	</ul></div>",$("#orderHeadInfo").html(e)}});var I={serviceId:"B03_findPocNoticeLineList",token:_vParams.token,secretNumber:_vParams.secretNumber,pocId:$scope.pocNoticeInfo.id.toString(),companyId:_vParams.companyId,commonParam:commonParam()};GetAJAXData("POST",I,function(o){if(o.success){$scope.lineList=o.pocNoticeLineList;var e="";e+='<h2 class="m-title">产品明细</h2>',$scope.lineList.forEach(function(o){o.unitName=!0,o.purchaseUnitName==o.valuationUnitName&&(o.unitName=!1),e+='<div class="item-wrap"><ul><li><span>产品编号：</span>'+o.prodCode+"</li><li><span>产品名称：</span>"+o.prodName+" "+o.prodScale+"</li><li><section><span>采购数量：</span><em>"+o.purchaseQty+"</em>"+o.purchaseUnitName+(o.unitName?"/<em>"+o.valuationQty+"</em>"+o.valuationUnitName:"")+"</section><section><span>预交期：</span><em>"+transDate(o.expectedDelivery)+'</em></section></li><li class="changeItem"><section><span>变更后：</span><em>'+o.changeQty+"</em>"+o.purchaseUnitName+(o.unitName?"/<em>"+o.changeValuationQty+"</em>"+o.valuationUnitName:"")+"</section><section><span>预交期：</span><em>"+transDate(o.changeExpectedDelivery)+"</em></section></li><li><span>单价：</span>"+$currencySymbol+(1==$scope.orderInfo.isContainTax?formatMoney(o.taxPrice,$priceDecimalNum):formatMoney(o.price,$priceDecimalNum))+"/"+o.valuationUnitName+'</li><li class="changeItem"><span>变更单价：</span>'+$currencySymbol+(1==$scope.orderInfo.isContainTax?formatMoney(o.changeTaxPrice,$priceDecimalNum):formatMoney(o.changePrice,$priceDecimalNum))+"/"+o.valuationUnitName+"</li><li><span>小计：</span>"+$currencySymbol+formatMoney(o.taxLineTotal,$amountDecimalNum)+'</li><li class="changeItem"><span>变更小计：</span>'+$currencySymbol+formatMoney(o.changeTaxLineTotal,$amountDecimalNum)+"</li></ul></div>",p(o)}),e+="</div>",$("#prodBodyInfo").html(e)}},!1);var N={serviceId:"B03_findPocNoticeOtherCostList",token:_vParams.token,secretNumber:_vParams.secretNumber,pocId:$scope.pocNoticeInfo.id.toString(),companyId:_vParams.companyId,commonParam:commonParam()};GetAJAXData("POST",N,function(o){if(o.success){$scope.costList=o.costList;var e="";e+='<h2 class="m-title">其他费用</h2><div class="item-wrap"><ul>',$scope.costList.forEach(function(o){e+="<li><span>"+o.costName+"：</span><b>"+$currencySymbol+formatMoney(o.costAmount,$amountDecimalNum)+'</b><b class="dj"><em class="money">'+formatMoney(o.changeCostAmount,$amountDecimalNum)+"</em></b></li>"}),e+='<li id="othersCostSubtotal" class="subtotal"><span>变更前：</span><b>'+$currencySymbol+formatMoney($scope.pocNoticeInfo.poOtherCostTotal,$amountDecimalNum)+'</b></li><li id="changeCost" class="response changeLineTotal"><span>变更后：</span>'+$currencySymbol+formatMoney($scope.pocNoticeInfo.otherCostTotal,$amountDecimalNum)+"</li></ul></div></div>",$("#othersCost").html(e)}}),$(".item-total").html("变更前订单总金额："+$currencySymbol+formatMoney($scope.pocNoticeInfo.poTotalAmount,$amountDecimalNum)).show(),$(".item-total-dj").html("变更后订单总金额："+$currencySymbol+formatMoney($scope.pocNoticeInfo.totalAmount,$amountDecimalNum)).show(),container.on("click","span.edit, a.item-link",function(){var a=$(this),s=a.attr("name"),i=$body.scrollTop();switch(s){case"changeCause":orderReviseInfoCon.html(e()),o("#changeCause",l.changeReason,$change.changeReasonVal),$("#intRemarks").val($change.changeRemark);break;case"payInfo":orderReviseInfoCon.html(n(i)),o("#logisticsType",$scope.logisticsType,$logisticsType.currValue);break;case"remark":orderReviseInfoCon.html(c(i))}$body.scrollTop(0),container.addClass("contarinEdit"),$("#jBottom").addClass("m-bottom-hide")}).on("click",".btn-wrap .btnB",function(){var o=$(this),e=o.attr("data-scrollTop");if(o.is("#saveChangeCause")){var n=$("#changeCause").select3("value")||"";n&&($change.changeReason=reEnumFn(l.reasonType,n),$change.changeReasonVal=n),$change.changeRemark=$("#intRemarks").val()}if(o.is("#savePayInfo")){var c=$("#logisticsType").select3("value")||"";c&&($logisticsType.currValue=c,$logisticsType.logisticsType=Number(reEnumFn(l.logisticsType,c)))}o.is("#saveRemark"),container.removeClass("contarinEdit"),$("#jBottom").removeClass("m-bottom-hide"),setTimeout(function(){$body.scrollTop(e)},200)}),bottomBar(["share"],$scope.pocNoticeInfo.pocManId,"","确定转销售变更"),GetAJAXData("POST",{serviceId:"B01_findFileList",docType:12,companyId:$scope.pocNoticeInfo.vendorId,searchType:1,id:$scope.pocNoticeInfo.soId,token:_vParams.token,secretNumber:_vParams.secretNumber,commonParam:commonParam()},function(o){o.success&&o.fileList.forEach(function(o){$scope.sc_files.push({id:o.id,fileName:o.fileName,fileSize:o.fileSize,fileUrl:o.fileUrl,lineNo:o.lineNo})})}),$body.on("click",".bottom-btn-confirm",function(){r("confirm","","您确定要转销售变更么？",function(){},function(){console.log(JSON.stringify(a())),$.ajax({type:"POST",url:config.serviceUrl,data:{param:JSON.stringify(a())},success:function(o){o.success?r("alert","","转销售变更成功！返回上一级",function(){},function(){goBack()}):r("alert","","转销售变更单错误提示信息："+o.errorMsg)}})})})}}};